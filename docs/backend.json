
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile within the BeMatch application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "The Firebase Authentication UID associated with this user."
        },
        "fullName": {
          "type": "string",
          "description": "The user's full name."
        },
        "dateOfBirth": {
          "type": "string",
          "description": "The user's date of birth.",
          "format": "date-time"
        },
        "gender": {
          "type": "string",
          "description": "The user's gender."
        },
        "genderPreference": {
          "type": "string",
          "enum": ["male", "female", "both"],
          "description": "The gender the user is interested in matching with."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "profilePicture": {
          "type": "string",
          "description": "URL of the user's main profile picture.",
          "format": "uri"
        },
        "images": {
          "type": "array",
          "description": "A list of URLs for the user's profile photos.",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },
        "interests": {
          "type": "array",
          "description": "A list of the user's interests.",
          "items": {
            "type": "string"
          }
        },
        "bio": {
          "type": "string",
          "description": "A short biography or description of the user."
        },
        "location": {
            "type": "object",
            "properties": {
                "latitude": {"type": "number"},
                "longitude": {"type": "number"}
            }
        },
        "distancePreference": {
            "type": "number",
            "description": "Maximum distance in kilometers for potential matches."
        }
      },
      "required": [
        "uid",
        "fullName",
        "dateOfBirth",
        "gender",
        "email"
      ]
    },
    "Match": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Match",
      "type": "object",
      "description": "Represents an interaction or match between two users.",
      "properties": {
        "user1Id": {
          "type": "string",
          "description": "The UID of the first user (lexicographically smaller)."
        },
        "user2Id": {
          "type": "string",
          "description": "The UID of the second user (lexicographically larger)."
        },
        "user1_action": {
          "type": "string",
          "enum": ["liked", "disliked"],
          "description": "The action taken by user1."
        },
        "user1_timestamp": {
            "type": "string",
            "format": "date-time"
        },
        "user2_action": {
          "type": "string",
          "enum": ["liked", "disliked"],
          "description": "The action taken by user2."
        },
        "user2_timestamp": {
            "type": "string",
            "format": "date-time"
        },
        "status": {
            "type": "string",
            "enum": ["pending", "matched"],
            "description": "The current status of the interaction."
        },
        "matchDate": {
          "type": "string",
          "description": "The date and time when the match was confirmed.",
          "format": "date-time"
        }
      },
      "required": [
        "user1Id",
        "user2Id",
        "status"
      ]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "Represents a single message within a chat conversation.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ChatMessage entity."
        },
        "matchId": {
          "type": "string",
          "description": "Reference to Match. (Relationship: Match 1:N ChatMessage)"
        },
        "senderId": {
          "type": "string",
          "description": "Reference to UserProfile who sent the message. (Relationship: UserProfile 1:N ChatMessage)"
        },
        "text": {
          "type": "string",
          "description": "The text content of the message."
        },
        "timestamp": {
          "type": "string",
          "description": "The date and time when the message was sent.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "matchId",
        "senderId",
        "text",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/entities/UserProfile"
          },
          "description": "Stores public user profile data."
        }
      },
      {
        "path": "/matches/{matchId}",
        "definition": {
          "entityName": "Match",
          "schema": {
            "$ref": "#/entities/Match"
          },
          "description": "Stores interaction data (likes, dislikes, matches) between two users. The document ID is a composite key of the two user UIDs, sorted lexicographically."
        }
      },
      {
        "path": "/users/{userId}/matches/{matchId}",
        "definition": {
          "entityName": "Match",
          "schema": {
            "$ref": "#/entities/Match"
          },
          "description": "Stores denormalized data for confirmed matches for a specific user, allowing for easy querying of a user's match list."
        }
      },
      {
        "path": "/matches/{matchId}/messages/{messageId}",
        "definition": {
          "entityName": "ChatMessage",
          "schema": {
            "$ref": "#/entities/ChatMessage"
          },
          "description": "Stores chat messages for a specific confirmed match. Access is controlled by match membership."
        }
      }
    ]
  }
}
